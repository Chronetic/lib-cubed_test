<br>
<div class="has-text-centered">
	<strong class="showfont has-text-dark">Your Comics</strong>
</div>
<div class="level">
	<div class="level-item">
		<%= link_to 'Back', "home", class: "button is-danger" %>
	</div>
	<div class="level-item">
		<%= link_to 'New Comic', new_comic_path, class: "button is-success" %>
	</div>
</div>

<% averagerating = 0 %>
<% totalcomics = 0 %>
<% totalpages = 0 %>

<body>
	<div class="container">
		<table class="table is-striped is-hoverable table center">
			<thead>
				<tr>
					<th></th>
					<th>Title</th>
					<th>Description</th>
					<th>Author</th>
					<th>Rating</th>
					<th>Pages</th>
					<th colspan="3"></th>
				</tr>
			</thead>

			<tbody>
				<% @comics.each.with_index(0) do |comic, index| %>
				<tr>
					<% if comic.user_id == current_user.id %>
					<td><%= "#{index}" %></td>
					<td><strong><%= link_to "#{comic.title}", comic %></strong></td>
					<td><%= truncate comic.description, length: 100, seperator: /\w+/ %></td>
					<td><%= comic.author %></td>
					<td><%= comic.comicrating %></td>
					<% averagerating+= comic.comicrating %>
					<td><%= comic.pages %></td>
					<% totalpages+= comic.pages %>
					<% totalcomics+= 1 %>
					<td><%= link_to 'Edit', edit_comic_path(comic) %></td>
					<td><%= link_to 'Destroy', comic, method: :delete, data: { confirm: 'Are you sure?' } %></td>
					<% end %>
				</tr>
				<% end %>
			</tbody>
		</table>
		<table class="table is-striped is-hoverable table center">
			<thead>
				<tr>
					<th>Stats:</th>
					<th>Comics</th>
					<th>Average Rating</th>
					<th>Total Pages</th>
					<th colspan="3"></th>
				</tr>
			</thead>

			<tbody>
				<tr>
					<td>Totals:</td>
					<td><p class="has-text-centered"><%= totalcomics %></p></td>
					<td><p class="has-text-centered"><%= (averagerating / totalcomics).round(2) %></p></td>
					<td><p class="has-text-centered"><%= totalpages %></p></td>
				</tr>
			</tbody>
		</table>
	</div>
</body>
